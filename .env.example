# =====================================================================
# Bug Bot — Environment Variable Reference
# Copy this file to .env and fill in real values.
# =====================================================================

# --- Slack ---
SLACK_SIGNING_SECRET=your-signing-secret
SLACK_BOT_TOKEN=xoxb-...
SLACK_APP_TOKEN=xapp-...
SLACK_BOT_USER_ID=U0XXXXXXX
BUG_REPORTS_CHANNEL_ID=C0XXXXXXX
BUG_SUMMARIES_CHANNEL_ID=C0XXXXXXX
SLACK_SOCKET_MODE=true
REQUIRE_BOT_MENTION=false

# --- Bug Bot internal database (PostgreSQL + asyncpg) ---
# Used for storing bug reports, investigations, service mappings, etc.
DATABASE_URL=postgresql+asyncpg://bugbot:bugbot@localhost:5433/bugbot

# --- Temporal ---
TEMPORAL_HOST=localhost:7233
TEMPORAL_NAMESPACE=default

# --- Anthropic ---
ANTHROPIC_API_KEY=sk-ant-...
CLAUDE_CLI_PATH=/usr/local/bin/claude

# --- GitHub ---
GITHUB_TOKEN=ghp_...
# Must match the GitHub organisation that owns the service repos.
GITHUB_ORG=your-org-name

# --- Grafana / Loki ---
GRAFANA_URL=http://localhost:3000
GRAFANA_API_KEY=
LOKI_URL=http://localhost:3100

# --- New Relic (optional) ---
# NEWRELIC_API_KEY=your-newrelic-key
# NEWRELIC_ACCOUNT_ID=your-account-id

# --- Read-only database connections (used by agent investigation tools) ---
# These are the customer application databases the agent queries during investigations.
#
# The service_team_mapping.database_name column stores the specific DB name for each
# service. The agent retrieves it via lookup_service_owner, then passes it as
# database_name to postgres_run_query / mysql_run_query, which substitute it into
# the URL at connection time. The host, port, and credentials below are shared across
# all service databases on the same host.

# PostgreSQL — scheme must be postgresql:// (psycopg3 format, NOT postgresql+asyncpg)
POSTGRES_READONLY_URL=postgresql://readonly:pass@localhost:5432/appdb

# MySQL — scheme can be mysql:// or mysql+pymysql://
MYSQL_READONLY_URL=mysql://readonly:pass@localhost:3306/appdb

# --- RAG ---
RAG_EMBEDDING_MODEL=all-MiniLM-L6-v2
RAG_TOP_K=5

# --- Feature flags ---
MOCK_AGENT=false
ENABLE_DUPLICATE_DETECTION=false
DUPLICATE_CHECK_WINDOW_HOURS=2
DUPLICATE_SIMILARITY_THRESHOLD=0.8
SUMMARY_POST_MODE=threaded
